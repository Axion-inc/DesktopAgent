# Web Engine Configuration for Desktop Agent
# Phase 6: Chrome DevTools Protocol (CDP) implementation

# Engine selection: "cdp" (recommended), "extension", or "playwright"
engine: "cdp"                # Default to new CDP engine

# Playwright engine configuration (existing)
playwright:
  headless: false
  timeout: 30000
  slow_mo: 100
  viewport:
    width: 1280
    height: 720
  user_agent: "Desktop Agent WebX/1.0"
  
# CDP engine configuration (Phase 6 - Primary)
cdp:
  # Extension ID - set after installation
  extension_id: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
  
  # Chrome DevTools Protocol configuration
  timeout: 30000                # CDP operation timeout (ms)
  dom_cache_ttl: 5000          # DOM tree cache TTL (ms)
  max_concurrent_operations: 5  # Max parallel CDP operations
  
  # Element interaction settings
  interaction:
    click_delay: 100           # Delay between click and next action (ms)
    fill_delay: 50             # Delay between keystrokes (ms)
    scroll_behavior: "smooth"   # Scroll behavior: "auto" | "smooth"
    highlight_duration: 2000    # Element highlight duration (ms)
  
  # Screenshot settings
  screenshot:
    format: "png"              # "png" | "jpeg"
    quality: 90                # 1-100 for JPEG
    viewport_only: true        # false for full page screenshots
  
  # DOM tree building options
  dom_tree:
    max_depth: 10              # Maximum DOM traversal depth
    include_invisible: false    # Include hidden elements
    include_text_nodes: false  # Include text-only nodes
    label_interactive_only: true # Only label interactive elements

# Extension engine configuration (Legacy - Phase 5)
extension:
  # Extension ID - set after installation  
  id: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
  
  # Native messaging host configuration
  native_host: "com.desktopagent.webx"
  
  # Handshake token for authentication
  handshake_token: "change-me-in-production"
  
  # Request timeout in milliseconds
  timeout_ms: 15000
  
  # Enable debugger permission for file uploads (default: false for security)
  enable_debugger_upload: false
  
  # Auto-reconnect settings
  max_reconnect_attempts: 3
  reconnect_delay_ms: 5000

# Common settings for both engines
common:
  # Screenshot configuration
  screenshot:
    quality: 80
    format: "png"
    full_page: false
  
  # Download handling
  download:
    default_directory: "./downloads"
    timeout_ms: 30000
    
  # Security settings
  security:
    # Mask sensitive fields in logs
    mask_sensitive_data: true
    sensitive_patterns:
      - "password"
      - "passwd" 
      - "pwd"
      - "secret"
      - "token"
      - "key"
      - "credit"
      - "card"
      - "ccv"
      - "cvv"
      - "ssn"
      - "social"
      - "pin"
      - "otp"
    
    # Require approval for destructive actions
    require_approval_for_destructive: true
    destructive_keywords:
      - "delete"
      - "remove"
      - "cancel"
      - "unsubscribe"
      - "logout"
      - "sign out"

# Metrics and monitoring
metrics:
  # Enable metrics collection
  enabled: true
  
  # Track performance metrics
  track_performance: true
  
  # Track error rates and types
  track_errors: true
  
  # Store artifacts (screenshots, DOM schemas)
  store_artifacts: true
  artifacts_directory: "./artifacts"

transport:
  # Choose host transport between 'ws' (default for dev) or 'native'
  type: "ws"  # ws | native
  ws_url: "ws://127.0.0.1:8765"
  timeout_sec: 30

# Development and debugging
development:
  # Enable verbose logging
  verbose_logging: false
  
  # Store debug artifacts
  debug_artifacts: false
  
  # Mock mode for testing
  mock_mode: false
